<!--
  Form at top to add new products (saves to DB automatically).
   Below: Button to refresh list from DB, shows products with quick details.
   Click "View Details" for more info on a single item. Errors show in red.
-->
<div class="demo-container">
  <!-- Form Section: Enter product details to save to database -->
  <section class="form-section">
    <h2>Create New Cabinet Product</h2>
    <form [formGroup]="createForm" (ngSubmit)="onCreateProduct()">
      <!-- Required: Wholesale SKU -->
      <label for="wSKU">Wholesale SKU (required):</label>
      <input id="wSKU" formControlName="wSKU" type="text" placeholder="e.g., CAB-WH-001">

      <!-- Required: Vendor SKU -->
      <label for="vSKU">Vendor SKU (required):</label>
      <input id="vSKU" formControlName="vSKU" type="text" placeholder="e.g., CAB-VN-001">

      <!-- Required: Brand -->
      <label for="brand">Brand (required):</label>
      <select id="brand" formControlName="brand">
        <option value="">Select Brand</option>
        <option value="BrandA">Brand A</option>
        <option value="BrandB">Brand B</option>
      </select>

      <!-- Required: Door Style -->
      <label for="doorStyle">Door Style (required):</label>
      <input id="doorStyle" formControlName="doorStyle" type="text" placeholder="e.g., Shaker">

      <!-- Optional: Discount -->
      <label for="discount">Discount (%):</label>
      <input id="discount" formControlName="discount" type="number" min="0" max="100">

      <!-- Optional: Retail Price -->
      <label for="retailPrice">Retail Price ($):</label>
      <input id="retailPrice" formControlName="retailPrice" type="number" min="0">

      <!-- Optional: Publish -->
      <label for="publish">
        <input id="publish" formControlName="publish" type="checkbox">
        Publish to site?
      </label>

      <!-- Submit Button: Saves to database -->
      <button type="submit" [disabled]="isLoading" class="btn-primary">
        {{ isLoading ? 'Saving...' : 'Create & Save to DB' }}
      </button>
    </form>

    <!-- Error Display: Shows if save fails -->
    <div *ngIf="errorMessage as msg" class="error">{{ msg }}</div>
  </section>

  <!-- List Section: Shows products read from database -->
  <section class="list-section">
    <h2>Cabinet Products from DB</h2>
    <button (click)="loadProducts()" [disabled]="isLoading" class="btn-secondary">
      {{ isLoading ? 'Loading...' : 'Refresh List' }}
    </button>

    <!-- List Display: Direct *ngFor on products array (simplified, no async/nested) -->
    <div *ngIf="products.length > 0; else noProducts">
      <ul class="product-list">
        <li *ngFor="let product of products; trackBy: trackById" class="product-item">
          <strong>{{ product?.brand || 'N/A' }} - {{ product?.doorStyle || 'N/A' }}</strong>
          <br>WSKU: {{ product?.wSKU || 'N/A' }} | Price: ${{ product?.retailPrice || 'N/A' }}
          <button (click)="getProductById(product.id)" class="btn-small">View Details</button>
        </li>
      </ul>
    </div>
    <ng-template #noProducts>
      <p>No products loaded yet â€“ create one above!</p>
    </ng-template>

    <!-- Single Product Details: Shows after "View Details" click -->
    <ng-container *ngIf="singleProduct as product">
      <details class="product-details">
        <summary>Details for {{ product!.id }}</summary>
        <p>Height: {{ product!.height || 'N/A' }} | Width: {{ product!.width || 'N/A' }} | Species: {{ product!.species || 'N/A' }}</p>
      </details>
    </ng-container>
  </section>
</div>
